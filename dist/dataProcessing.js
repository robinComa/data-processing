"use strict";function expose(){var a=window.DataProcessing;DataProcessing.noConflict=function(){return window.DataProcessing=a,this},window.DataProcessing=DataProcessing}var DataProcessing={version:"0.0.0"};"object"==typeof module&&"object"==typeof module.exports?module.exports=DataProcessing:"function"==typeof define&&define.amd?define(DataProcessing):expose(),DataProcessing.Util={extend:function(a){var b,c,d,e,f=Array.prototype.slice.call(arguments,1);for(c=0,d=f.length;d>c;c++){e=f[c];for(b in e)a[b]=e[b]}return a},create:Object.create||function(){function a(){}return function(b){return a.prototype=b,new a}}(),bind:function(a,b){var c=Array.prototype.slice;if(a.bind)return a.bind.apply(a,c.call(arguments,1));var d=c.call(arguments,2);return function(){return a.apply(b,d.length?d.concat(c.call(arguments)):arguments)}},Blob:function(a,b){if(typeof Blob==typeof Function)return new window.Blob(a,b);var c=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return c.append(a),c.getBlob(b.type)},URL:window.URL||window.webkitURL,unSerialize:function(serializedObj,objClass){var obj=eval("("+atob(serializedObj)+")");if(objClass===DataProcessing.Processing)return new objClass(obj.args,obj.userFn);throw"unSerialize ERROR : Unsupported class."}},DataProcessing.extend=DataProcessing.Util.extend,DataProcessing.bind=DataProcessing.Util.bind,DataProcessing.Class=function(){},DataProcessing.Class.extend=function(a){this.prototype.serialize=function(){return btoa(JSON.stringify(this))};var b=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks.length&&this.callInitHooks()},c=b.__super__=this.prototype,d=DataProcessing.Util.create(c);d.constructor=b,b.prototype=d;for(var e in this)this.hasOwnProperty(e)&&"prototype"!==e&&(b[e]=this[e]);return a.statics&&(DataProcessing.extend(b,a.statics),delete a.statics),a.includes&&(DataProcessing.Util.extend.apply(null,[d].concat(a.includes)),delete a.includes),d.options&&(a.options=DataProcessing.Util.extend(DataProcessing.Util.create(d.options),a.options)),DataProcessing.extend(d,a),d._initHooks=[],d.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var a=0,b=d._initHooks.length;b>a;a++)d._initHooks[a].call(this)}},b},DataProcessing.Class.include=function(a){DataProcessing.extend(this.prototype,a)},DataProcessing.Class.mergeOptions=function(a){DataProcessing.extend(this.prototype.options,a)},DataProcessing.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1),c="function"==typeof a?a:function(){this[a].apply(this,b)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c)},DataProcessing.Processing=DataProcessing.Class.extend({initialize:function(a,b){return this.args=a,this.userFn=b.toString(),this.fn=b,this},run:function(){var a=DataProcessing.Util.Blob([this._workerCodeCreation()],{type:"text/javascript"}),b=DataProcessing.Util.URL.createObjectURL(a),c=new Worker(b),d=this;c.onmessage=function(a){if(!d._onFinish)throw'You should attach a "onFinish" callback function';d._onFinish(a.data)}},onFinish:function(a){return this._onFinish=a,this},_workerCodeCreation:function(){var a=JSON.stringify(this.args),b=this._workerScaffolding.toString();return b=b.replace("null",this.fn.toString()),b=b.replace("userCode()","userCode("+a.slice(1,a.length-1)+")"),["(",b,")();"].join("")},_workerScaffolding:function(){this.userCode=null,postMessage(this.userCode())}});